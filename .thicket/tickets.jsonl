{"id":"MM-0ub230","title":"Move mining swing logic out of completeAction","description":"completeAction still contains a mining-specific branch (if action is MiningAction) that calls _completeMiningSwing. This could be moved into _processMiningForeground to fully decouple mining from the generic action completion path.","type":"task","status":"open","priority":3,"labels":null,"assignee":"","created":"2026-02-01T23:41:04.324089Z","updated":"2026-02-01T23:41:04.324089Z"}
{"id":"MM-0v2hv2","title":"Cap mastery pool XP during tick processing to prevent exceeding max","description":"addSkillMasteryXp in state.dart does not cap the pool XP at the maximum. During tick processing (consume_ticks.dart), mastery pool XP from action completions could theoretically exceed the max. Consider adding a cap in addSkillMasteryXp itself or at the call sites in consumeTicks.","type":"bug","status":"open","priority":3,"labels":null,"assignee":"","created":"2026-02-01T06:08:44.778218Z","updated":"2026-02-01T06:08:44.778218Z"}
{"id":"MM-1th6es","title":"Extract summoning-specific completion handler","description":"SummoningAction has unique behavior in completeAction (marks tablet as crafted). Consider extracting a _completeSummoningAction handler similar to mining/thieving/cooking for consistency.","type":"task","status":"open","priority":4,"labels":null,"assignee":"","created":"2026-02-01T18:01:37.667165Z","updated":"2026-02-01T18:01:37.667165Z"}
{"id":"MM-28ik14","title":"Apply slayer area effects during combat","description":"SlayerArea has an areaEffect field with modifiers that should be applied to the player during combat in that area. Currently these effects are parsed but not used in combat calculations.","type":"feature","status":"open","priority":2,"labels":null,"assignee":"","created":"2026-02-01T05:59:11.152022Z","updated":"2026-02-01T05:59:11.152022Z"}
{"id":"MM-2zelt9","title":"ensure mastery tokens drop and can be redeemed","description":"They should not be possible to redeem if the would waste some of the mastery (e.g. go beyond 100%)","type":"","status":"closed","priority":2,"labels":null,"assignee":"","created":"2026-02-01T02:02:40.550981Z","updated":"2026-02-01T06:08:39.414917Z"}
{"id":"MM-40qqb6","title":"Add thieving drop integration test for NPC unique drops","description":"The existing thieving tests verify NPC unique drops are parsed, but there is no integration test that runs tick processing and confirms an NPC unique drop actually lands in inventory (similar to the existing Golbin loot table integration test).","type":"task","status":"open","priority":3,"labels":null,"assignee":"","created":"2026-02-01T02:40:45.948093Z","updated":"2026-02-01T02:40:45.948093Z"}
{"id":"MM-5ulqrd","title":"examine consumeTicks for architectural simplicity/clarity","description":"Right now consumeTicks seems to have a log of skill-specific logic in it, rather than being then general loop.  Maybe that's right, but I think we should look to see if more clarity is possible.\n\nalso all 'as Foo' usage is code smell.","type":"task","status":"closed","priority":1,"labels":null,"assignee":"","created":"2026-02-01T00:51:11.663112Z","updated":"2026-02-01T00:56:52.226706Z"}
{"id":"MM-6ff562","title":"Improve test coverage from 88% to 90%+","description":"Logic package test coverage is at 88.2% (11799/13370 lines). Biggest gaps: modifier_names.dart (353 uncovered, generated file), state.dart (209 uncovered), solver files, township_state.dart (39 uncovered). Need ~234 more lines covered to reach 90%.","type":"task","status":"open","priority":3,"labels":null,"assignee":"","created":"2026-02-01T16:25:44.475201Z","updated":"2026-02-01T16:25:44.475201Z"}
{"id":"MM-7rz3fs","title":"Add spend-all mastery pool button to level multiple actions at once","description":"Allow spending mastery pool XP across all actions evenly, or spending enough to max a specific action. Currently only +1 level at a time.","type":"feature","status":"open","priority":3,"labels":null,"assignee":"","created":"2026-02-01T03:20:59.792864Z","updated":"2026-02-01T03:20:59.792864Z"}
{"id":"MM-7ypm80","title":"Move mining-specific foreground logic (respawn, depletion) out of _processSkillForeground","description":"Mining has special foreground behavior: respawn waiting (blocking the foreground) and node depletion after completion. These are mixed into _processSkillForeground via 'is MiningAction' checks. Consider making mining use its own foreground processor like combat/agility do, or adding beforeProgress/afterComplete hooks to SkillAction.","type":"task","status":"closed","priority":2,"labels":null,"assignee":"","created":"2026-02-01T00:57:07.87118Z","updated":"2026-02-01T05:26:34.191672Z"}
{"id":"MM-80bc3u","title":"Add widget tests for mastery pool claim tokens dialog","description":"The _ClaimMasteryTokensDialog in mastery_pool.dart and the _ClaimMasteryTokenSection in bank.dart lack widget tests. Add Flutter widget tests that verify the claim buttons appear/disappear based on token availability, that dispatching works correctly, and that the dialog shows correct pool stats.","type":"task","status":"open","priority":3,"labels":null,"assignee":"","created":"2026-02-01T17:46:16.949163Z","updated":"2026-02-01T17:46:16.949163Z"}
{"id":"MM-8ddtio","title":"implement summon synergies","description":"https://wiki.melvoridle.com/w/Synergy\n\nJust the logic, we can do the UI pass in a separate ticket.\n\nimportantly when a would-be synergy is equipped, if the synergy does not apply to the current skill, don't consider the synergy, but do still consider potentially one of the parts applying to the currnet skill.","type":"feature","status":"open","priority":2,"labels":null,"assignee":"","created":"2026-02-01T05:44:53.34659Z","updated":"2026-02-01T05:44:53.34659Z"}
{"id":"MM-8sk6e1","title":"display \"slayer areas\"","description":"Right now we have \"slayer tasks\" but in the real game it's also possible to singularly fight monsters within a \"slayer area\" (just like combat areas).  We don't seem to display those in the combat ui yet.  We should do so instead of the \"slayer task\" button and move the slayer task button slightly down.  It's important that we always check that the player meets the requirements of a slayer area to fight a monster there.\n\ngear changes that would cause the player to no longer meet requiremetns of the area must fail and display an error toast.","type":"","status":"closed","priority":1,"labels":null,"assignee":"","created":"2026-02-01T05:06:47.674333Z","updated":"2026-02-01T05:59:05.863493Z"}
{"id":"MM-cpuepd","title":"Exclude generated files from coverage metrics","description":"modifier_names.dart is a generated file (GENERATED FILE - DO NOT EDIT) with 353 uncovered lines that drags overall coverage from 90.6% to 88.3%. Add a coverage exclusion or filter for generated files so coverage metrics reflect only hand-written code.","type":"task","status":"open","priority":3,"labels":null,"assignee":"","created":"2026-02-01T17:46:18.1523Z","updated":"2026-02-01T17:46:18.1523Z"}
{"id":"MM-d9vn07","title":"Extract StateUpdateBuilder into its own file to enable virtual methods on SkillAction","description":"StateUpdateBuilder is defined in consume_ticks.dart, which creates a circular dependency barrier preventing SkillAction subclasses from having virtual completion methods. Extracting StateUpdateBuilder into a separate file (e.g., state_update_builder.dart) would allow data-layer classes to accept it as a parameter, enabling true polymorphic dispatch for skill-specific tick processing logic.","type":"task","status":"closed","priority":1,"labels":null,"assignee":"","created":"2026-02-01T02:52:56.417582Z","updated":"2026-02-01T03:12:13.027781Z"}
{"id":"MM-fa52c7","title":"Confirm thieving drop rates from Melvor wiki or game source","description":"thieving.dart has TODO comments noting areaUniqueDropRate (1/500) and npcUniqueDropRate (1/500) need confirmation from the Melvor wiki or game source code.","type":"task","status":"open","priority":3,"labels":null,"assignee":"","created":"2026-02-01T02:40:41.312732Z","updated":"2026-02-01T02:40:41.312732Z"}
{"id":"MM-g3tez9","title":"Refactor _processSkillForeground mining/cooking type checks into switch dispatch","description":"The _processSkillForeground function still uses if-chain type checks for MiningAction (respawn waiting) and CookingAction (passive cooking ticks). These 'before progress' and 'during progress' hooks could be refactored into a switch expression similar to _completeSkillAction, or into beforeProgress/duringProgress virtual methods once StateUpdateBuilder is extractable.","type":"","status":"closed","priority":2,"labels":null,"assignee":"","created":"2026-02-01T02:52:59.219699Z","updated":"2026-02-01T16:34:13.619423Z"}
{"id":"MM-h1y48f","title":"Implement the ability to spend the mastery pool","description":"Will need to show all possible actions in a dialog and have a +1 button that spend mastery pool to raise that action to the next mastery level.  Button should be green if possible (without cxrosisng a boundary), yellow if it would cross a boundary (and show a warning dialog before doing so), and red if insuffient mastery pool points","type":"task","status":"closed","priority":1,"labels":null,"assignee":"","created":"2026-02-01T02:04:52.141631Z","updated":"2026-02-01T03:20:54.318624Z"}
{"id":"MM-j56daw","title":"Improve overall test coverage to 90%","description":"Overall logic package coverage is at 88.3%. Identify and add tests for the least-covered files to bring it above 90%.","type":"task","status":"open","priority":2,"labels":null,"assignee":"","created":"2026-02-01T16:34:28.780322Z","updated":"2026-02-01T16:34:28.780322Z"}
{"id":"MM-jd4qk0","title":"ensure potions is implemented","description":"","type":"task","status":"closed","priority":2,"labels":null,"assignee":"","created":"2026-02-01T02:02:00.944228Z","updated":"2026-02-01T05:44:44.935693Z"}
{"id":"MM-jhs99x","title":"add double-click to equip/swap in bank","description":"","type":"","status":"open","priority":2,"labels":null,"assignee":"","created":"2026-02-01T06:01:24.9405Z","updated":"2026-02-01T06:01:24.9405Z"}
{"id":"MM-kc5oq7","title":"Apply synergy conditional enemy modifiers","description":"ConditionalModifier has an optional enemyModifiers field. The current ModifierProvider synergy integration only applies condMod.modifiers but not condMod.enemyModifiers. If any synergy conditional modifiers have enemy modifiers, they would be ignored.","type":"feature","status":"open","priority":3,"labels":null,"assignee":"","created":"2026-02-01T23:48:20.90726Z","updated":"2026-02-01T23:48:20.90726Z"}
{"id":"MM-l26vvp","title":"Remove mining depletion guard from _completeSkillAction","description":"After extracting mining respawn to _processMiningForeground, a MiningAction depletion guard still remains in _completeSkillAction to prevent stopAction from being called when a node depletes. Ideally _processMiningForeground would handle completion directly so the generic path has no mining awareness at all.","type":"","status":"closed","priority":2,"labels":null,"assignee":"","created":"2026-02-01T05:26:45.382385Z","updated":"2026-02-01T23:40:53.725256Z"}
{"id":"MM-nr885u","title":"Parse conditionalModifiers on summoning synergies","description":"SummoningSynergy.fromJson only parses 'modifiers' but ignores 'conditionalModifiers'. 5 synergies in Melvor data have PotionUsedCondition conditional modifiers (Bird Nest Potion, Perfect Swing Potion, Elemental Potion, Seeing Gold Potion, Controlled Heat Potion). These need to be parsed and applied through the modifier provider for synergy effects to work with active potions.","type":"","status":"closed","priority":2,"labels":null,"assignee":"","created":"2026-02-01T05:44:51.603532Z","updated":"2026-02-02T00:08:34.693011Z"}
{"id":"MM-o4qxme","title":"ensure we've added all thieving drops","description":"thieving has at least 3 levels of drops\nnpc\narea\nnpc unique\nmake sure all of them are working.","type":"task","status":"closed","priority":2,"labels":null,"assignee":"","created":"2026-02-01T00:49:30.290253Z","updated":"2026-02-01T02:40:32.483863Z"}
{"id":"MM-ojk4t7","title":"Add tests for slayer area combat and gear validation","description":"Add unit tests for: startSlayerAreaCombat, meetsSlayerAreaRequirements, unmetSlayerAreaRequirements, slayerAreaGearChangeError, and SlayerAreaCombatContext serialization.","type":"task","status":"open","priority":2,"labels":null,"assignee":"","created":"2026-02-01T05:59:20.411797Z","updated":"2026-02-01T05:59:20.411797Z"}
{"id":"MM-rcvq5f","title":"Move thieving/cooking completion out of _completeSkillAction","description":"Similar to the mining extraction, thieving (stun/death) and cooking (success/fail/passive) have their own 'is' checks in _completeSkillAction. Consider giving each their own completion handler or foreground processor to make _completeSkillAction truly generic.","type":"","status":"closed","priority":2,"labels":null,"assignee":"","created":"2026-02-01T05:26:41.275384Z","updated":"2026-02-01T18:01:23.64971Z"}
{"id":"MM-rzjmif","title":"Add deity change option to township settings","description":"Once a deity is selected in township, there is no UI affordance to change it. Consider adding a way to change deity selection from the town view, similar to clearWorship() which already exists in the state layer.","type":"feature","status":"open","priority":3,"labels":null,"assignee":"","created":"2026-02-01T16:25:48.589268Z","updated":"2026-02-01T16:25:48.589268Z"}
{"id":"MM-shz2p5","title":"diety confirm dialog should show diety or statue","description":"","type":"task","status":"open","priority":3,"labels":null,"assignee":"","created":"2026-02-01T02:50:05.63686Z","updated":"2026-02-01T02:50:05.63686Z"}
{"id":"MM-t434kk","title":"don't show township tabs until diety chosen","description":"","type":"","status":"closed","priority":2,"labels":null,"assignee":"","created":"2026-02-01T02:49:36.793883Z","updated":"2026-02-01T16:25:32.806284Z"}
{"id":"MM-tdus9b","title":"Wire up mastery token claiming UI","description":"The claimMasteryToken and claimAllMasteryTokens methods exist in GlobalState but have no UI to trigger them. Add a button on the inventory mastery token item or the skill page to claim tokens.","type":"","status":"closed","priority":2,"labels":null,"assignee":"","created":"2026-02-01T03:21:01.650798Z","updated":"2026-02-01T17:46:03.03388Z"}
{"id":"MM-urmacj","title":"Convert completeAction mining/summoning type checks to switch","description":"The completeAction helper still has MiningAction and SummoningAction type checks (for _completeMiningSwing and markTabletCrafted). These could be moved into the switch in _completeSkillAction or into dedicated completion methods.","type":"task","status":"open","priority":3,"labels":null,"assignee":"","created":"2026-02-01T16:34:24.949242Z","updated":"2026-02-01T16:34:24.949242Z"}
{"id":"MM-wtlo8o","title":"Add tests for potion charge preservation mechanic","description":"consumePotionCharge in state_update_builder.dart has charge preservation logic (line ~706-711) that checks potionChargePreservationChance modifier. This path has no dedicated tests. Should verify that charges are preserved when the random roll succeeds.","type":"task","status":"open","priority":3,"labels":null,"assignee":"","created":"2026-02-01T05:44:56.623755Z","updated":"2026-02-01T05:44:56.623755Z"}
{"id":"MM-wwcn7q","title":"Improve test coverage for state.dart","description":"state.dart has 85.5% coverage with 209 missed lines. Add tests covering untested branches to help reach 90% overall coverage.","type":"task","status":"open","priority":3,"labels":null,"assignee":"","created":"2026-02-01T18:01:37.674831Z","updated":"2026-02-01T18:01:37.674831Z"}
{"id":"MM-y03cim","title":"Make SkillAction a sealed class for exhaustive switch dispatch","description":"SkillAction and its subclasses (ThievingAction, CookingAction, MiningAction, etc.) use runtime type checks via 'is' throughout consume_ticks.dart. Making SkillAction sealed would enable Dart's exhaustive pattern matching, so the compiler catches missing cases when a new skill subclass is added. This is a prerequisite for cleanly eliminating type-check dispatch in _completeSkillAction and _processSkillForeground.","type":"task","status":"open","priority":3,"labels":null,"assignee":"","created":"2026-02-01T02:57:56.451252Z","updated":"2026-02-01T02:57:56.451252Z"}
{"id":"MM-y6hw1o","title":"Add slayer area combat context progress indicator","description":"When fighting in a slayer area, show a progress card similar to the dungeon/slayer task progress cards, indicating which slayer area the player is in.","type":"feature","status":"open","priority":3,"labels":null,"assignee":"","created":"2026-02-01T05:59:12.885474Z","updated":"2026-02-01T05:59:12.885474Z"}
{"id":"MM-yyk25q","title":"write yourself a coverage script","description":"Right now the agent spends a while at the end of each PR computing coverage.  Presumably we can make that simpler by writing you a small script and checking it in","type":"task","status":"open","priority":2,"labels":null,"assignee":"","created":"2026-02-01T23:41:23.12875Z","updated":"2026-02-01T23:41:23.12875Z"}
{"id":"MM-znjec1","title":"Move skill-specific completion logic into SkillAction subclass methods","description":"Currently _processSkillForeground dispatches on 'is ThievingAction', 'is CookingAction', 'is MiningAction' etc. for completion handling. These could become virtual methods on SkillAction subclasses (e.g. onComplete, beforeProgress) to eliminate type checks and make adding new skill-specific behavior easier. The _completeSkillAction helper extracted in MM-5ulqrd is the main candidate.","type":"task","status":"closed","priority":2,"labels":null,"assignee":"","created":"2026-02-01T00:57:02.060658Z","updated":"2026-02-01T02:52:50.506386Z"}
{"id":"MM-zqd3tf","title":"Eliminate 'is Foo' type checks in completeAction for SummoningAction and MiningAction","description":"completeAction() in consume_ticks.dart uses 'is SummoningAction' to call markTabletCrafted and 'is MiningAction' for resource depletion. These post-completion hooks could be moved into the action subclasses via a virtual method.","type":"task","status":"open","priority":3,"labels":null,"assignee":"","created":"2026-02-01T00:57:13.408057Z","updated":"2026-02-01T00:57:13.408057Z"}
{"id":"MM-d1pmw08","from_ticket_id":"MM-y6hw1o","to_ticket_id":"MM-8sk6e1","type":"created_from","created":"2026-02-01T05:59:12.887051Z"}
{"id":"MM-d2k5lca","from_ticket_id":"MM-y03cim","to_ticket_id":"MM-znjec1","type":"created_from","created":"2026-02-01T02:57:56.453145Z"}
{"id":"MM-d3bhrzr","from_ticket_id":"MM-28ik14","to_ticket_id":"MM-8sk6e1","type":"created_from","created":"2026-02-01T05:59:11.153841Z"}
{"id":"MM-d3t36on","from_ticket_id":"MM-6ff562","to_ticket_id":"MM-t434kk","type":"created_from","created":"2026-02-01T16:25:44.476612Z"}
{"id":"MM-d47f15u","from_ticket_id":"MM-40qqb6","to_ticket_id":"MM-o4qxme","type":"created_from","created":"2026-02-01T02:40:45.949331Z"}
{"id":"MM-d4cbcbq","from_ticket_id":"MM-zqd3tf","to_ticket_id":"MM-5ulqrd","type":"created_from","created":"2026-02-01T00:57:13.409218Z"}
{"id":"MM-d5wd02s","from_ticket_id":"MM-0v2hv2","to_ticket_id":"MM-2zelt9","type":"created_from","created":"2026-02-01T06:08:44.779742Z"}
{"id":"MM-d6ibfk2","from_ticket_id":"MM-0ub230","to_ticket_id":"MM-l26vvp","type":"created_from","created":"2026-02-01T23:41:04.325734Z"}
{"id":"MM-d8fqwot","from_ticket_id":"MM-ojk4t7","to_ticket_id":"MM-8sk6e1","type":"created_from","created":"2026-02-01T05:59:20.413468Z"}
{"id":"MM-d8zo61m","from_ticket_id":"MM-j56daw","to_ticket_id":"MM-g3tez9","type":"created_from","created":"2026-02-01T16:34:28.781751Z"}
{"id":"MM-dam6gvi","from_ticket_id":"MM-cpuepd","to_ticket_id":"MM-tdus9b","type":"created_from","created":"2026-02-01T17:46:18.153719Z"}
{"id":"MM-dcyz1b4","from_ticket_id":"MM-l26vvp","to_ticket_id":"MM-7ypm80","type":"created_from","created":"2026-02-01T05:26:45.383658Z"}
{"id":"MM-deeijmq","from_ticket_id":"MM-80bc3u","to_ticket_id":"MM-tdus9b","type":"created_from","created":"2026-02-01T17:46:16.951199Z"}
{"id":"MM-dfh6jif","from_ticket_id":"MM-d9vn07","to_ticket_id":"MM-znjec1","type":"created_from","created":"2026-02-01T02:52:56.41927Z"}
{"id":"MM-dhg5wwt","from_ticket_id":"MM-wwcn7q","to_ticket_id":"MM-rcvq5f","type":"created_from","created":"2026-02-01T18:01:37.676087Z"}
{"id":"MM-dhoxj7b","from_ticket_id":"MM-nr885u","to_ticket_id":"MM-jd4qk0","type":"created_from","created":"2026-02-01T05:44:51.605038Z"}
{"id":"MM-diveq3p","from_ticket_id":"MM-urmacj","to_ticket_id":"MM-g3tez9","type":"created_from","created":"2026-02-01T16:34:24.95055Z"}
{"id":"MM-dktojx4","from_ticket_id":"MM-tdus9b","to_ticket_id":"MM-h1y48f","type":"created_from","created":"2026-02-01T03:21:01.652344Z"}
{"id":"MM-dp108b2","from_ticket_id":"MM-kc5oq7","to_ticket_id":"MM-nr885u","type":"created_from","created":"2026-02-01T23:48:20.908729Z"}
{"id":"MM-dpqef60","from_ticket_id":"MM-rcvq5f","to_ticket_id":"MM-7ypm80","type":"created_from","created":"2026-02-01T05:26:41.276981Z"}
{"id":"MM-dr8q0xk","from_ticket_id":"MM-fa52c7","to_ticket_id":"MM-o4qxme","type":"created_from","created":"2026-02-01T02:40:41.314043Z"}
{"id":"MM-dv1leos","from_ticket_id":"MM-g3tez9","to_ticket_id":"MM-znjec1","type":"created_from","created":"2026-02-01T02:52:59.221641Z"}
{"id":"MM-dw0gu03","from_ticket_id":"MM-wtlo8o","to_ticket_id":"MM-jd4qk0","type":"created_from","created":"2026-02-01T05:44:56.625297Z"}
{"id":"MM-dw4f5g6","from_ticket_id":"MM-7rz3fs","to_ticket_id":"MM-h1y48f","type":"created_from","created":"2026-02-01T03:20:59.79429Z"}
{"id":"MM-dxo3uye","from_ticket_id":"MM-1th6es","to_ticket_id":"MM-rcvq5f","type":"created_from","created":"2026-02-01T18:01:37.668699Z"}
{"id":"MM-dy3rqzk","from_ticket_id":"MM-znjec1","to_ticket_id":"MM-5ulqrd","type":"created_from","created":"2026-02-01T00:57:02.072769Z"}
{"id":"MM-dyn7b7i","from_ticket_id":"MM-7ypm80","to_ticket_id":"MM-5ulqrd","type":"created_from","created":"2026-02-01T00:57:07.872277Z"}
{"id":"MM-dyydl4h","from_ticket_id":"MM-rzjmif","to_ticket_id":"MM-t434kk","type":"created_from","created":"2026-02-01T16:25:48.590741Z"}
